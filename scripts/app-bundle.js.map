{"version":3,"sources":["app.js","environment.js","main.js","dashboard/dashboard.js","resources/index.js","sign-in/sign-in.js","dashboard/index/index.js","dashboard/orgs-create/orgs-create.js","dashboard/orgs-list/orgs-list.js","dashboard/orgs-show/orgs-show.js","resources/attributes/place-autocomplete.js"],"names":["App","httpClient","router","message","configure","config","withBaseUrl","apiEndpoint","withInterceptor","request","headers","set","localStorage","getItem","response","status","removeItem","navigate","configureRouter","title","addPipelineStep","AuthorizeStep","options","pushState","map","route","redirect","moduleId","nav","settings","roles","name","run","navigationInstruction","next","getAllInstructions","some","i","indexOf","isAuthenticated","cancel","debug","testing","Promise","longStackTraces","warnings","wForgottenReturn","aurelia","use","standardConfiguration","globalResources","feature","developmentLogging","plugin","start","then","setRoot","Dashboard","activate","fetch","method","body","accessKey","r","json","account","signOut","navigateToRoute","SignIn","realm","hasError","isFetching","transition","setItem","signIn","mailAddress","email","password","catch","e","console","log","Index","OrgsCreate","input","category","address","contact","errors","create","JSON","stringify","data","id","x","OrgsList","organisations","OrgsShow","isEditing","all","org","orgAccessKey","startEdit","parse","cancelEdit","update","delete","confirm","PlaceAutocompleteCustomAttribute","Element","element","created","restrictions","attached","google","maps","event","addDomListener","keyCode","preventDefault","types","componentRestrictions","country","autocomplete","places","Autocomplete","navigator","geolocation","getCurrentPosition","lat","position","coords","latitude","lng","longitude","circle","Circle","center","radius","accuracy","setBounds","getBounds","targetProperty","target","formattedAddress","value","addListener","place","getPlace","googleObject","formatted_address","placeId","place_id","address_components","forEach","googlePropertyName","geometry","location","appPlace","street_number","street1","postal_code","postalCode","locality","googleMapId","userSelectionBinding"],"mappings":"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","file":"app-bundle.js","sourcesContent":["import environment from './environment';\n\nimport {Redirect} from 'aurelia-router';\nimport {inject} from 'aurelia-framework';\nimport {HttpClient, json} from 'aurelia-fetch-client';\nimport {Router} from 'aurelia-router';\n\n@inject(HttpClient, Router)\nexport class App {\n  constructor(httpClient, router) {\n    this.httpClient = httpClient;\n\n    this.message = 'Hello World!';\n\n    this.httpClient.configure(config => {\n      config\n        .withBaseUrl(environment.apiEndpoint)\n        .withInterceptor({\n         request(request) {\n           request.headers.set(\"AccessKey\", localStorage.getItem('accessKey'));\n           return request;\n         },\n         response(response) {\n           if (response.status >= 400 && response.status <= 599) {\n             //if (window.location.pathname != '/sign-in') {\n             if (response.status == 401) {\n               localStorage.removeItem('accessKey');\n               router.navigate('/sign-in');\n             }\n             //}\n             throw response;\n           }\n          return response;\n         }\n       });\n    });\n  }\n\n  configureRouter(config, router) {\n     config.title = 'CPA Admin';\n     config.addPipelineStep('authorize', AuthorizeStep);\n     config.options.pushState = false;\n     config.map([\n       { route: '', redirect: 'dashboard' },\n       { route: 'dashboard', moduleId: './dashboard/dashboard', title: 'Dashboard', nav: true, settings: { roles: [ 'authenticated' ] } },\n       { route: 'sign-in', moduleId: './sign-in/sign-in', name: 'sign-in', title: 'Sign in', settings: { roles: [] } },\n     ]);\n     this.router = router;\n   }\n}\n\n\nclass AuthorizeStep {\n  run(navigationInstruction, next) {\n    if (navigationInstruction.getAllInstructions().some(i => i.config.settings.roles.indexOf('authenticated') !== -1)) {\n      var isAuthenticated = localStorage.getItem('accessKey') != null;\n      if (!isAuthenticated) {\n        return next.cancel(new Redirect('sign-in'));\n      }\n    }\n\n    return next();\n  }\n}\n","export default {\n  debug: false,\n  testing: false\n};\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .globalResources('resources/attributes/place-autocomplete')\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  environment.apiEndpoint = \"http://api.cpafrance.fr/\";\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import {inject} from 'aurelia-framework';\nimport {Router} from 'aurelia-router';\nimport {HttpClient, json} from 'aurelia-fetch-client';\n\n@inject(HttpClient, Router)\nexport class Dashboard {\n  constructor(httpClient, router) {\n    this.httpClient = httpClient;\n  }\n\n  configureRouter(config, router) {\n     config.map([\n       { route: '', moduleId: './index/index', name: 'd-index', title: 'Index', nav: true },\n       { route: 'organisations', moduleId: './orgs-list/orgs-list', name: 'd-orgs-list', title: 'Organisations', nav: true },\n       { route: 'organisations/:id', moduleId: './orgs-show/orgs-show', name: 'd-orgs-show' },\n       { route: 'organisations/create', moduleId: './orgs-create/orgs-create', name: 'd-orgs-create' },\n     ]);\n     this.router = router;\n   }\n\n  activate() {\n    return this.httpClient\n      .fetch('authentication', {\n        method: 'POST',\n        body: json({\n          accessKey: localStorage.getItem('accessKey')\n        })\n      })\n      .then(r => r.json())\n      .then(account => {\n        this.account = account;\n      });\n  }\n\n  signOut() {\n    localStorage.removeItem('accessKey');\n    this.router.navigateToRoute('sign-in');\n  }\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","import {inject} from 'aurelia-framework';\nimport {HttpClient, json} from 'aurelia-fetch-client';\nimport {Router} from 'aurelia-router';\n\n@inject(HttpClient, Router)\nexport class SignIn {\n  constructor(httpClient, router) {\n    this.httpClient = httpClient;\n    this.router = router;\n\n    this.realm = 'A';\n    \n    this.hasError = false;\n    this.isFetching = false;\n  }\n\n  activate(transition) {\n    if (transition.accessKey) {\n      localStorage.setItem('accessKey', transition.accessKey);\n      this.router.navigate('/dashboard');\n    }\n  }\n\n  signIn() {\n    this.hasError = false;\n    this.isFetching = true;\n\n    this.httpClient\n      .fetch('authentication', {\n        method: 'POST',\n        body: json({\n          mailAddress: this.email,\n          password: this.password,\n          realm: this.realm,\n        }),\n      })\n      .then(r => r.json())\n      .then(account => {\n        this.isFetching = false;\n        localStorage.setItem('accessKey', account.accessKey);\n        this.router.navigate('/dashboard');\n      })\n      .catch((e) => {\n        console.log(e)\n        this.hasError = true;\n        this.isFetching = false;\n      });\n    ;\n  }\n}\n","export class Index {\n\n}\n","import {inject} from 'aurelia-framework';\nimport {HttpClient, json} from 'aurelia-fetch-client';\nimport {Router} from 'aurelia-router';\n\n@inject(HttpClient, Router)\nexport class OrgsCreate {\n  constructor(httpClient, router) {\n    this.httpClient = httpClient;\n    this.router = router;\n\n    this.input = {\n      category: 'universitÃ©',\n      address: {},\n      contact: {},\n    }\n    this.errors = {};\n  }\n\n  create() {\n    console.log(JSON.stringify(this.input, null, 2))\n    this.errors = {};\n    this.httpClient\n      .fetch('organisations', {\n        method: 'POST',\n        body: json(this.input)\n      })\n      .then(r => r.json())\n      .then(data => {\n        console.log('data', data)\n        this.router.navigateToRoute('d-orgs-show', { id: data.id });\n      })\n      .catch(e => {\n        console.log(e)\n        if (e.status == 409) {\n          this.errors.mailAddress = \"Conflict\";\n          console.log(this.errors)\n          return;\n        }\n        e.json().then(x => this.errors = x);\n      });\n  }\n}\n","import {inject} from 'aurelia-framework';\nimport {HttpClient, json} from 'aurelia-fetch-client';\n\n@inject(HttpClient)\nexport class OrgsList {\n  constructor(httpClient) {\n    this.httpClient = httpClient;\n  }\n\n  activate() {\n    return this.httpClient.fetch('organisations')\n      .then(r => r.json())\n      .then(data => this.organisations = data);\n  }\n}\n","import {inject} from 'aurelia-framework';\nimport {HttpClient, json} from 'aurelia-fetch-client';\nimport {Router} from 'aurelia-router';\n\n@inject(HttpClient, Router)\nexport class OrgsShow {\n  constructor(httpClient, router) {\n    this.httpClient = httpClient;\n    this.router = router;\n\n    this.isEditing = false;\n    this.input = null;\n    this.errors = {};\n  }\n\n  activate(transition) {\n    console.log(transition)\n    return Promise.all([\n      this.httpClient.fetch(`organisations/${transition.id}`)\n        .then(r => r.json())\n        .then(data => {\n          this.org = data\n        }),\n      this.httpClient.fetch(`organisations/${transition.id}/accessKey`)\n        .then(r => r.json())\n        .then(data => {\n          this.orgAccessKey = data.accessKey;\n        })\n        .catch(e => console.log(e))\n    ]);\n  }\n\n  startEdit() {\n    this.isEditing = true;\n    this.input = JSON.parse(JSON.stringify(this.org));\n  }\n\n  cancelEdit() {\n    this.isEditing = false;\n    this.input = null;\n  }\n\n  update() {\n    this.httpClient\n      .fetch(`organisations/${this.input.id}`, {\n        method: 'PUT',\n        body: json(this.input)\n      })\n      .then(r => {\n        this.org = this.input;\n        this.cancelEdit();\n      })\n      .catch(e => e.json().then(x => this.errors = x));\n  }\n\n  delete() {\n    if (!confirm('Are you sure you want to delete this organisation?')) {\n      return;\n    }\n\n    this.httpClient\n      .fetch(`organisations/${this.org.id}`, {\n        method: 'DELETE'\n      })\n      .then(r => {\n        this.router.navigateToRoute('d-orgs-list');\n      })\n      .catch(e => console.log(e));\n  }\n\n  get orgAsJSON() {\n    return JSON.stringify(this.org, null, 2)\n  }\n}\n","import { inject } from 'aurelia-framework';\nimport { bindable } from 'aurelia-framework'\n\n@inject(Element)\nexport class PlaceAutocompleteCustomAttribute {\n\n    @bindable target;\n    @bindable userSelectionBinding;\n    @bindable targetProperty;\n    @bindable restrictions;\n    element;\n    autocomplete;\n\n    constructor(element) {\n        this.element = element;\n    }\n\n    created() {\n        if (!this.restrictions) {\n            this.restrictions = [\"geocode\"];\n        }\n        else if (this.restrictions == 'regions') {\n            this.restrictions = [\"(regions)\"];\n        }\n    }\n\n    attached() {\n\n        google.maps.event.addDomListener(this.element, 'keydown', function (e) {\n            if (e.keyCode == 13) {\n                console.log('enter')\n                e.preventDefault();\n            }\n        });\n\n        let options = {\n            types: this.restrictions,\n            componentRestrictions: { country: \"fr\" },\n        };\n        this.autocomplete = new google.maps.places.Autocomplete(this.element, options);\n\n        if (navigator.geolocation) {\n            navigator.geolocation.getCurrentPosition(position => {\n                let geolocation = {\n                    lat: position.coords.latitude,\n                    lng: position.coords.longitude\n                };\n                let circle = new google.maps.Circle({\n                    center: geolocation,\n                    radius: position.coords.accuracy\n                });\n                this.autocomplete.setBounds(circle.getBounds());\n            });\n        }\n        this.targetProperty = [this.targetProperty || \"address\"];\n        if (this.target[this.targetProperty] && this.target[this.targetProperty].formattedAddress) {\n            this.element.value = this.target[this.targetProperty].formattedAddress;\n        }\n\n        this.autocomplete.addListener('place_changed', () => {\n            let place = this.autocomplete.getPlace();\n            let googleObject = { formatted_address: place.formatted_address, placeId: place.place_id };\n\n            // extract array elements and map them to object properties.\n            place.address_components.forEach(x => {\n                let googlePropertyName = x.types[0];\n                googleObject[googlePropertyName] = x[\"short_name\"];\n            });\n            googleObject.lat = place.geometry.location.lat();\n            googleObject.lng = place.geometry.location.lng();\n\n            // home made object, will be use for API calls.\n            var appPlace = {};\n            appPlace.formattedAddress = googleObject.formatted_address;\n\n\n            if (googleObject.street_number || googleObject.route) {\n                appPlace.street1 = googleObject.street_number ? googleObject.street_number + \" \" + googleObject.route : googleObject.route;\n            }\n            if (googleObject.postal_code) {\n                appPlace.postalCode = googleObject.postal_code;\n            }\n            appPlace.locality = googleObject.locality.indexOf(\"Paris-\") == 0 ? \"Paris\" : googleObject.locality;\n            appPlace.country = googleObject.country == \"FR\" ? \"France\" : googleObject.country;\n\n            appPlace.lat = googleObject.lat\n            appPlace.lng = googleObject.lng;\n            appPlace.googleMapId = googleObject.placeId;\n\n            this.target[this.targetProperty] = appPlace;\n            if (this.userSelectionBinding) {\n                this.element.value = appPlace[this.userSelectionBinding];\n            }\n        });\n    }\n}\n"],"sourceRoot":"../src"}